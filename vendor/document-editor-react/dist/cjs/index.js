"use strict";var e=require("react");function n(e,n,o,t){return new(o||(o=Promise))((function(i,s){function r(e){try{c(t.next(e))}catch(e){s(e)}}function d(e){try{c(t.throw(e))}catch(e){s(e)}}function c(e){var n;e.done?i(e.value):(n=e.value,n instanceof o?n:new o((function(e){e(n)}))).then(r,d)}c((t=t.apply(e,n||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const o=(e,n,o,t)=>{const i=document.createElement("script");return i.id=e,i.type="text/javascript",i.src=n,i.async=!0,i.onload=()=>{i.removeAttribute("loading"),o(null)},i.onerror=e=>{i.removeAttribute("loading"),t(e)},i.setAttribute("loading",""),i};exports.DocumentEditor=t=>{const{id:i,documentServerUrl:s,config:r,document_fileType:d,document_title:c,documentType:a,editorConfig_lang:u,height:l,type:v,width:w,onLoadComponentError:p,events_onAppReady:R,events_onDocumentStateChange:g,events_onMetaChange:m,events_onDocumentReady:f,events_onInfo:y,events_onWarning:h,events_onError:E,events_onRequestSharingSettings:q,events_onRequestRename:D,events_onMakeActionLink:_,events_onRequestInsertImage:S,events_onRequestSaveAs:I,events_onRequestMailMergeRecipients:A,events_onRequestCompareFile:C,events_onRequestEditRights:b,events_onRequestHistory:k,events_onRequestHistoryClose:M,events_onRequestHistoryData:P,events_onRequestRestore:H,events_onRequestSelectSpreadsheet:x,events_onRequestSelectDocument:L}=t;e.useEffect((()=>{var e;(null===(e=null===window||void 0===window?void 0:window.DocEditor)||void 0===e?void 0:e.instances[i])&&(window.DocEditor.instances[i].destroyEditor(),window.DocEditor.instances[i]=void 0,console.log("Important props have been changed. Load new Editor."),T())}),[s,JSON.stringify(r),d,c,a,u,l,v,w]),e.useEffect((()=>{let e=s;e.endsWith("/")||(e+="/");return((e,t)=>n(void 0,void 0,void 0,(function*(){return new Promise(((n,i)=>{try{if(window.DocsAPI)return n(null);const s=document.getElementById(t);if(s){let r=setInterval((()=>{if(!s.getAttribute("loading")){if(clearInterval(r),window.DocsAPI)return n(null);const d=o(t,e,n,i);s.remove(),document.body.appendChild(d)}}),500)}else{const s=o(t,e,n,i);document.body.appendChild(s)}}catch(e){console.error(e)}}))})))(`${e}web-apps/apps/api/documents/api.js`,"onlyoffice-api-script").then((()=>T())).catch((()=>j(-2))),()=>{var e;(null===(e=null===window||void 0===window?void 0:window.DocEditor)||void 0===e?void 0:e.instances[i])&&(window.DocEditor.instances[i].destroyEditor(),window.DocEditor.instances[i]=void 0)}}),[]);const T=()=>{var e,n;try{if(window.DocsAPI||j(-3),null===(e=null===window||void 0===window?void 0:window.DocEditor)||void 0===e?void 0:e.instances[i])return void console.log("Skip loading. Instance already exists",i);(null===(n=null===window||void 0===window?void 0:window.DocEditor)||void 0===n?void 0:n.instances)||(window.DocEditor={instances:{}});let o=Object.assign({document:{fileType:d,title:c},documentType:a,editorConfig:{lang:u},events:{onAppReady:W,onDocumentStateChange:g,onMetaChange:m,onDocumentReady:f,onInfo:y,onWarning:h,onError:E,onRequestSharingSettings:q,onRequestRename:D,onMakeActionLink:_,onRequestInsertImage:S,onRequestSaveAs:I,onRequestMailMergeRecipients:A,onRequestCompareFile:C,onRequestEditRights:b,onRequestHistory:k,onRequestHistoryClose:M,onRequestHistoryData:P,onRequestRestore:H,onRequestSelectSpreadsheet:x,onRequestSelectDocument:L},height:l,type:v,width:w},r||{});const t=window.DocsAPI.DocEditor(i,o);window.DocEditor.instances[i]=t}catch(e){console.error(e),j(-1)}},j=e=>{let n;switch(e){case-2:n="Error load DocsAPI from "+s;break;case-3:n="DocsAPI is not defined";break;default:n="Unknown error loading component",e=-1}void 0===p?console.error(n):p(e,n)},W=()=>{R(window.DocEditor.instances[i])};return e.createElement("div",{id:i})};
//# sourceMappingURL=index.js.map
